{"ast":null,"code":"import firebase from 'firebase/compat/app';\nimport 'firebase/compat/auth';\nimport 'firebase/compat/firestore';\nimport 'firebase/compat/storage';\nexport var USER_STATE_CHANGE = 'USER_STATE_CHANGE';\nexport var userAuthStateListener = function userAuthStateListener() {\n  return function (dispatch) {\n    firebase.auth().onAuthStateChanged(function (user) {\n      if (user) {\n        dispatch(getCurrentUserData());\n      } else {\n        dispatch({\n          type: USER_STATE_CHANGE,\n          currentUser: null,\n          loaded: true\n        });\n      }\n    });\n  };\n};\nexport var getUserById = function getUserById(id) {\n  return new Promise(function (resolve, reject) {\n    firebase.firestore().collection('users').doc(id).get().then(function (snapshot) {\n      resolve(snapshot.exists ? snapshot.data() : null);\n    }).catch(function () {\n      return reject();\n    });\n  });\n};\nexport var getCurrentUserData = function getCurrentUserData() {\n  return function (dispatch) {\n    firebase.firestore().collection('users').doc(firebase.auth().currentUser.uid).onSnapshot(function (res) {\n      if (res.exists) {\n        return dispatch({\n          type: USER_STATE_CHANGE,\n          currentUser: res.data(),\n          loaded: true\n        });\n      }\n    });\n  };\n};\nexport var saveUserField = function saveUserField(name, imageURL, email, phone, birthday, address) {\n  return new Promise(function (resolve, reject) {\n    var obj = {\n      imageURL: imageURL,\n      name: name,\n      email: email,\n      phone: phone,\n      birthday: birthday,\n      address: address\n    };\n    console.log('test', name, imageURL, email, phone, birthday, address);\n    firebase.firestore().collection('users').doc(firebase.auth().currentUser.uid).update(obj).then(function () {\n      return resolve();\n    }).catch(function () {\n      return reject();\n    });\n  });\n};","map":{"version":3,"names":["firebase","USER_STATE_CHANGE","userAuthStateListener","dispatch","auth","onAuthStateChanged","user","getCurrentUserData","type","currentUser","loaded","getUserById","id","Promise","resolve","reject","firestore","collection","doc","get","then","snapshot","exists","data","catch","uid","onSnapshot","res","saveUserField","name","imageURL","email","phone","birthday","address","obj","console","log","update"],"sources":["D:/PhatTrienUngDungMobile/Project/Final/Shops_Pet/Shops_Pet/redux/actions/authAction.js"],"sourcesContent":["import firebase from 'firebase/compat/app';\nimport 'firebase/compat/auth';\nimport 'firebase/compat/firestore';\nimport 'firebase/compat/storage';\n\nexport const USER_STATE_CHANGE = 'USER_STATE_CHANGE'\n\nexport const userAuthStateListener = () => dispatch => {\n    firebase.auth().onAuthStateChanged((user) => {\n        if (user) {\n            dispatch(getCurrentUserData())\n        } else {\n            dispatch({ type: USER_STATE_CHANGE, currentUser: null, loaded: true })\n        }\n    })\n}\n\nexport const getUserById = (id) => new Promise((resolve, reject) => {\n    firebase.firestore()\n        .collection('users')\n        .doc(id)\n        .get()\n        .then((snapshot) => {\n            resolve(snapshot.exists ? snapshot.data() : null)\n        })\n        .catch(() => reject())\n})\n\nexport const getCurrentUserData = () => dispatch => {\n    firebase.firestore()\n        .collection('users')\n        .doc(firebase.auth().currentUser.uid)\n        .onSnapshot((res) => {\n            if (res.exists) {\n                return dispatch({\n                    type: USER_STATE_CHANGE,\n                    currentUser: res.data(),\n                    loaded: true\n                })\n            }\n        })\n}\n\nexport const saveUserField = (name, imageURL, email, phone, birthday, address) => new Promise((resolve, reject) => {\n    let obj = {\n        imageURL,\n        name,\n        email,\n        phone,\n        birthday,\n        address\n    };\n    console.log('test', name, imageURL, email, phone, birthday, address)\n    // obj[field] = value\n    firebase.firestore()\n        .collection('users')\n        .doc(firebase.auth().currentUser.uid)\n        .update(obj)\n        .then(() => resolve())\n        .catch(() => reject())\n})"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,qBAAqB;AAC1C,OAAO,sBAAsB;AAC7B,OAAO,2BAA2B;AAClC,OAAO,yBAAyB;AAEhC,OAAO,IAAMC,iBAAiB,GAAG,mBAAmB;AAEpD,OAAO,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAqB;EAAA,OAAS,UAAAC,QAAQ,EAAI;IACnDH,QAAQ,CAACI,IAAI,EAAE,CAACC,kBAAkB,CAAC,UAACC,IAAI,EAAK;MACzC,IAAIA,IAAI,EAAE;QACNH,QAAQ,CAACI,kBAAkB,EAAE,CAAC;MAClC,CAAC,MAAM;QACHJ,QAAQ,CAAC;UAAEK,IAAI,EAAEP,iBAAiB;UAAEQ,WAAW,EAAE,IAAI;UAAEC,MAAM,EAAE;QAAK,CAAC,CAAC;MAC1E;IACJ,CAAC,CAAC;EACN,CAAC;AAAA;AAED,OAAO,IAAMC,WAAW,GAAG,SAAdA,WAAW,CAAIC,EAAE;EAAA,OAAK,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAK;IAChEf,QAAQ,CAACgB,SAAS,EAAE,CACfC,UAAU,CAAC,OAAO,CAAC,CACnBC,GAAG,CAACN,EAAE,CAAC,CACPO,GAAG,EAAE,CACLC,IAAI,CAAC,UAACC,QAAQ,EAAK;MAChBP,OAAO,CAACO,QAAQ,CAACC,MAAM,GAAGD,QAAQ,CAACE,IAAI,EAAE,GAAG,IAAI,CAAC;IACrD,CAAC,CAAC,CACDC,KAAK,CAAC;MAAA,OAAMT,MAAM,EAAE;IAAA,EAAC;EAC9B,CAAC,CAAC;AAAA;AAEF,OAAO,IAAMR,kBAAkB,GAAG,SAArBA,kBAAkB;EAAA,OAAS,UAAAJ,QAAQ,EAAI;IAChDH,QAAQ,CAACgB,SAAS,EAAE,CACfC,UAAU,CAAC,OAAO,CAAC,CACnBC,GAAG,CAAClB,QAAQ,CAACI,IAAI,EAAE,CAACK,WAAW,CAACgB,GAAG,CAAC,CACpCC,UAAU,CAAC,UAACC,GAAG,EAAK;MACjB,IAAIA,GAAG,CAACL,MAAM,EAAE;QACZ,OAAOnB,QAAQ,CAAC;UACZK,IAAI,EAAEP,iBAAiB;UACvBQ,WAAW,EAAEkB,GAAG,CAACJ,IAAI,EAAE;UACvBb,MAAM,EAAE;QACZ,CAAC,CAAC;MACN;IACJ,CAAC,CAAC;EACV,CAAC;AAAA;AAED,OAAO,IAAMkB,aAAa,GAAG,SAAhBA,aAAa,CAAIC,IAAI,EAAEC,QAAQ,EAAEC,KAAK,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,OAAO;EAAA,OAAK,IAAIrB,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM,EAAK;IAC/G,IAAIoB,GAAG,GAAG;MACNL,QAAQ,EAARA,QAAQ;MACRD,IAAI,EAAJA,IAAI;MACJE,KAAK,EAALA,KAAK;MACLC,KAAK,EAALA,KAAK;MACLC,QAAQ,EAARA,QAAQ;MACRC,OAAO,EAAPA;IACJ,CAAC;IACDE,OAAO,CAACC,GAAG,CAAC,MAAM,EAAER,IAAI,EAAEC,QAAQ,EAAEC,KAAK,EAAEC,KAAK,EAAEC,QAAQ,EAAEC,OAAO,CAAC;IAEpElC,QAAQ,CAACgB,SAAS,EAAE,CACfC,UAAU,CAAC,OAAO,CAAC,CACnBC,GAAG,CAAClB,QAAQ,CAACI,IAAI,EAAE,CAACK,WAAW,CAACgB,GAAG,CAAC,CACpCa,MAAM,CAACH,GAAG,CAAC,CACXf,IAAI,CAAC;MAAA,OAAMN,OAAO,EAAE;IAAA,EAAC,CACrBU,KAAK,CAAC;MAAA,OAAMT,MAAM,EAAE;IAAA,EAAC;EAC9B,CAAC,CAAC;AAAA"},"metadata":{},"sourceType":"module"}